#pragma once

#include <vector>

namespace qpsk {

const u_int8_t base_matrix[20][13] = {
    {1,1,0,0,1,1,1,0,1,0,1,0,1},
    {1,0,1,0,1,0,0,1,1,1,0,1,0},
    {0,1,1,0,0,1,0,1,0,1,1,1,0},
    {0,0,0,1,1,1,1,1,1,1,1,1,1},
    {1,1,1,1,0,0,0,1,0,0,1,1,0},
    {0,1,1,1,1,0,1,0,1,0,0,1,1},
    {1,0,1,1,1,1,0,0,0,1,0,0,1},
    {1,1,0,1,0,1,1,1,0,0,1,0,0},
    {0,1,1,0,1,0,1,1,1,0,0,1,0},
    {0,0,1,1,0,1,0,1,1,1,0,0,1},
    {1,0,0,1,1,0,1,0,1,1,1,0,0},
    {0,1,0,0,1,1,0,1,0,1,1,1,0},
    {0,0,1,0,0,1,1,0,1,0,1,1,1},
    {1,0,0,1,0,0,1,1,0,1,0,1,1},
    {1,1,0,0,1,0,0,1,1,0,1,0,1},
    {1,1,1,0,0,1,0,0,1,1,0,1,0},
    {0,1,1,1,0,0,1,0,0,1,1,0,1},
    {1,0,1,1,1,0,0,1,0,0,1,1,0},
    {0,1,0,1,1,1,0,0,1,0,0,1,1},
    {1,0,1,0,1,1,1,0,0,1,0,0,1}
};

class BlockCode {
public:
    explicit BlockCode(int n);

    std::vector<u_int8_t> encode(const std::vector<bool>& info_bits) const;
    std::vector<bool> decode(const std::vector<double>& llrs) const;

private:
    int n_;
    std::vector<std::vector<u_int8_t>> G_;

    void init_generator_matrix();
};

} // namespace qpsk
